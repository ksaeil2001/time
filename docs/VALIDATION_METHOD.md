# Auto Shutdown Scheduler Validation Method (STEP 3)

> Last synced with implementation: 2026-02-16 (commit N/A - git metadata unavailable)

## A) 철학/목표

### 1) 30초 이해 가능(정의)
- 첫 진입 사용자가 30초 안에 아래 3가지를 말할 수 있어야 한다.
- `현재 상태`(대기 중/예약됨/최종 경고)
- `정확한 종료 시각 + 남은 시간`
- `취소/미루기 경로`(하단 빠른 액션, 최종 경고 오버레이, 트레이)

### 2) 3초 상태 파악 품질 게이트
- 어떤 라우트에서든 화면 노출 후 3초 이내에 `상태 배지`, `남은 시간`, `종료 시점`이 시각적으로 식별되어야 한다.
- 활성 예약(`Armed`/`FinalWarning`)일 때 `Cancel/Snooze` 진입 경로가 가려지면 실패다.

### 3) 검증 원칙
- 안전 동작(취소/미루기/최종 경고)은 “보이는 것”이 아니라 “실행 가능성”으로 판정한다.
- 접근성은 수동 확인만으로 끝내지 않고 자동화 + 수동 QA를 함께 통과해야 한다.

## B) 태스크 기반 검증 시나리오

아래 시나리오는 QA 1명이 그대로 따라 실행할 수 있도록 작성했다.

### 시나리오 1: 1시간 후 종료 예약 생성 → 취소 → 10분 미루기
- 사전조건: 활성 예약 없음, 온보딩 완료.
- 단계:
1. `새 예약`에서 카운트다운 60분 입력.
2. `예약 확인하기`를 눌러 확인 모달 진입.
3. 모달에서 `예약 시작(Arm)` 실행.
4. 하단 빠른 액션에서 `취소` 실행.
5. 다시 예약 Arm 후 `10분 미루기` 실행.
- 기대결과:
1. Arm 전에는 활성 상태로 전환되지 않는다.
2. 취소 후 상태가 `대기 중(예약 없음)`으로 복귀한다.
3. 미루기 후 종료 시점이 +10분 재계산된다.

### 시나리오 2: 특정 시각 모드에서 과거 시각 입력 처리
- 사전조건: 현재 시각 확인 가능.
- 단계:
1. `새 예약`에서 특정 시각 모드 선택.
2. 현재 시각보다 과거 시각 입력.
3. 확인 모달의 종료 시점 문구 확인.
- 기대결과:
1. 종료 시점이 “다음 날 동일 시각”으로 계산되어 표시된다.
2. 절대시각 + 상대시간이 동시에 노출된다.

### 시나리오 3: 프로세스 감시 모드에서 목록 비어있음 폴백
- 사전조건: 프로세스 조회 실패/빈 목록 상태 유도(권한 제한 또는 mock).
- 단계:
1. `새 예약`에서 `프로세스 감시` 모드 선택.
2. 프로세스 목록 영역 확인.
3. `새로고침`/대체 CTA 확인.
- 기대결과:
1. 빈 상태 메시지와 대체 경로(시간 기반 모드 전환)가 함께 표시된다.
2. 권한/조회 실패 메시지는 원인과 다음 행동(재시도/설정 확인)을 포함한다.

### 시나리오 4: 키보드만으로 주요 플로우 완료
- 사전조건: 마우스 사용 금지.
- 단계:
1. 모드 선택 → 입력 → 확인 모달 진입 → `예약 시작(Arm)` 실행.
2. 활성 상태에서 `Tab` 이동으로 `취소`와 `10분 미루기` 도달 확인.
- 기대결과:
1. Arm까지 키보드만으로 수행 가능.
2. 활성 상태에서 Footer 기준 2동작 이내 `취소` 또는 `10분 미루기` 도달 가능.
3. 모든 인터랙티브 요소에 포커스 링이 보인다.

### 시나리오 5: Final Warning 오버레이 접근성
- 사전조건: 최종 경고 상태 진입.
- 단계:
1. Final Warning 오버레이 표시 확인.
2. `Tab`/`Shift+Tab`으로 포커스 순환 확인.
3. `취소` 또는 `미루기` 실행 후 오버레이 닫힘 확인.
- 기대결과:
1. 오버레이에 `role="alertdialog"`가 적용되어야 한다.
2. 포커스 트랩이 동작해야 한다.
3. 오버레이 종료 시 포커스가 이전 요소로 복귀해야 한다.

### 시나리오 6: 이력 키보드 탐색 + 행 선택 + 상세 드로어
- 사전조건: 이력 데이터 1건 이상.
- 단계:
1. `이력` 화면 진입.
2. `Tab`으로 테이블 행 포커스.
3. `Enter`로 상세 열기.
4. 상세 드로어 닫기.
- 기대결과:
1. 행 선택이 키보드로 동작한다.
2. 상세 드로어가 열리고 이벤트 원문 확인 가능.
3. 닫기 후 포커스가 이전 선택 행으로 복귀한다.

### 시나리오 7: 알림/권한 폴백 문구 검증
- 사전조건: 알림 비활성 또는 권한 제한 상태.
- 단계:
1. `알림 설정`에서 상태 배너 확인.
2. `권한 및 동작 안내`, `도움말`의 가이드 문구 확인.
- 기대결과:
1. “시스템 알림이 꺼져 있어 사전 알림을 받지 못할 수 있습니다.”가 노출된다.
2. 앱 내 액션 경로(하단 바/오버레이/트레이) 안내가 유지된다.

## C) 합격 기준(정량/정성)

### 1) 정량 기준
- 태스크 성공률: 핵심 시나리오(1~6) 기준 `>= 95%`.
- 과업 시간:
1. 예약 생성+Arm: `<= 60초`
2. 활성 상태 취소/미루기 실행: `<= 10초`
3. 이력 상세 열기: `<= 15초`
- 치명 오류 수:
1. 안전 동작 차단(취소/미루기 불가): `0`
2. Arm 확인 없이 활성화: `0`
3. 접근성 자동 테스트 serious/critical 위반: `0`

### 2) 정성 기준
- SEQ(단일 과업 난이도, 1~7): 평균 `>= 5.5`.
- 간이 SUS(5문항, 0~100 환산): 평균 `>= 72`.
- 상태 이해도 질문:
1. “지금 상태가 무엇인지” 즉답 가능(3초 이내).
2. “취소/미루기는 어디서 하는지” 즉답 가능(30초 내).

### 3) 이벤트 로그 스캔 테스트(필수)
- 테스트 질문: “최근 이벤트 3개가 무엇인지 5초 내 말할 수 있나요?”
- 합격 기준:
1. 5초 내 3개 중 2개 이상 정확히 설명.
2. 이벤트 결과(완료/취소/실패) 1개 이상 정확히 식별.

## D) 체크리스트 (Design QA 실행용)

### Clarity
- [ ] TopStatusBar에서 상태/남은 시간/종료 시점을 3초 내 식별 가능
- [ ] 확인 모달에 “무엇/언제/취소 경로/알림 임계값”이 모두 보임
- [ ] 절대시각 + 상대시간이 동시에 노출됨

### Safety
- [ ] Arm은 확인 모달 승인 전 실행되지 않음
- [ ] Final Warning(기본 60초, 설정 15~300초)에서 취소/미루기 가능
- [ ] 하단 빠른 액션/오버레이/트레이에서 취소 경로 유지
- [ ] 단일 활성 예약 정책이 모든 진입점에서 일관됨

### Accessibility
- [ ] 포커스 링이 모든 인터랙티브 컴포넌트에서 보임
- [ ] 키보드만으로 모드 선택 → 입력 → 확인 → Arm 가능
- [ ] `aria-live`가 `polite/assertive`로 분리되어 상태 변화를 전달
- [ ] Final Warning이 `alertdialog` + 포커스 트랩 + 포커스 복귀를 만족
- [ ] Tab 2동작 이내 취소/10분 미루기 도달 가능
- [ ] 색상 단독 의존 없이 배지에 텍스트+아이콘 동시 제공

### Error
- [ ] 알림 비활성/권한 제한 시 폴백 메시지와 대체 경로가 표시됨
- [ ] process-exit 빈 목록/조회 실패 시 재시도 + 전환 CTA가 표시됨
- [ ] 상태 파일 손상/복구 실패 문구가 행동 지침과 함께 노출됨

### Localization
- [ ] 한국어 문자열 길이로 인한 레이아웃 깨짐 없음
- [ ] 시간/숫자 표기가 일관(시:분:초, 분 단위)함
- [ ] `Ctrl/Cmd` 병기 문구가 플랫폼별로 혼동을 주지 않음

## E) 회귀 방지 포인트 (리팩토링 후 취약 구간)

### P0
- Cancel/Snooze 접근성: 하단 빠른 액션과 Final Warning에서 항상 실행 가능해야 함.
- Final Grace 동작성: 카운트다운 중에도 취소/미루기 가능해야 함.
- Arm 확인 절차: 어떤 진입점에서도 무확인 Arm 금지.

### P1
- 시간 표기 규칙: 절대시각 + 상대시간 동시 노출.
- process-exit 알림 규칙: 10/5/1 사전 알림 없이 완료 감지 후 Final Warning 직행.
- History 키보드 상세 탐색: 행 선택/드로어 열기/닫힘 복귀 유지.

### P2
- 배지/칩 대비값 미세 조정으로 발생하는 A11Y 경계값 회귀.
- 도움말/권한 문구 변경 시 로컬라이제이션 줄바꿈 회귀.

## 자동 검증 채널

### 채널 1: Playwright E2E + axe-core
- 명령: `npm run test:e2e`
- 파일: `e2e/a11y-flow.e2e.ts`
- 커버리지:
1. Idle → 예약 생성(카운트다운) → 확인 모달 → Arm
2. Armed 상태 Cancel/Snooze 키보드 접근성
3. History 키보드 탐색 + 행 선택 + 상세 드로어

### 채널 2: Vitest(jsdom) + jest-axe
- 명령: `npm run test:a11y`
- 파일: `src/a11y.test.tsx`
- 커버리지:
1. Final Warning alertdialog 시맨틱 스모크
2. HistoryTable 키보드 Enter 동작
3. Badge 텍스트+아이콘 동시 렌더

## 실행 순서 (QA 운영 기준)
1. `npm run test:a11y`
2. `npm run test:e2e`
3. 수동 시나리오(1~7) 수행
4. 정량/정성 기준 판정 기록
5. 회귀 포인트(P0/P1/P2) 체크 후 릴리즈 승인
